"""
Created on Thu Apr  9 21:57:26 2020

@author: 王志
"""

本程序功能：
1：读取excel格式的校友数据库文件，及其他补充信息，生成根据时间先后更新的数据库信息或更新校友的个人简历（40个关键字段）。
2：读取任意问卷（excel格式），不需要更改问卷的表头等信息，自动识别新的信息，补充到数据库中。
3：每个校友（如有多份工作经历）创建个人简历，单独保存。
4：读取信息尽全力保证（如读到历史信息，会保存在校友的简历中，而不会将信息扔掉）
6：信息筛选，正则化匹配对信息筛选，去掉问卷中的无效信息。去除换行符或异常字符等
5：输出三类文件，全部校友的信息，疑似相同校友的信息，校友的简历

如何使用：
1：准备user_config.ini文件
2：准备config.json文件
3：运行
4：检查结果。（由于输出是utf-8编码，直接拖到excel会乱码，需要在记事本里打开保存为ANSI编码然后再用excel打开）
后期重复使用时，只需要将之前的结果保存下来，下次再在之前的基础上去更新，修改user_config.ini和config.json即可


策略说明：    
        1：对于Base文件不做去重处理，认为之前的结果是ok的
        2：读取Plus文件时,如果有学号，且和之前重复，认为一定是一个人。否则我进一步去看名字和学院，如果这两个和之前的对上了，认为是疑似为一个人，放到疑似数据库，否则就是新的人。
        3：如果其他问卷文件时（由于问卷几乎没有学号信息，且重复率可能更高，条件更严格），主要看名字，手机和学院。如果名字重复了，而且名字和手机号和之前对上，认为一定是一个人；否则，看学院，如果名字和学院对上了，放到疑似数据库。除此之外其他都认为是新的人。
   

补充说明：
1：code经过测试，但是不保证没有错误，要是有错误我可以再改。
2：code源码可以提供，也比较简单，只是涉及到数据库很繁琐，框架不用动，以后可以给一个懂python的学生专门来改。

准备文件的说明：
1：user_config.ini  ##告诉程序一些输入参数，路径等信息
[file_name]
Base_file=B_resuult.xlsx   ##之前同学整理的B结果，我把他分成了三块,这个是主要部分
Base_plus1=B_plus1.xlsx    ##之前同学整理的B结果，次要部分
Base_plus2=B_plus2.xlsx    ##次要部分
Config_file=config.json     ##下一个读取的配置文件的名字
Identify_file=identify.json    ##字段识别的配置文件名字        

[command]
if_read_plus1=True   ##是否读取plus1,以后这个可以设置为False
if_read_plus2=True   ##是否读取plus2,以后这个可以设置为False
[path]
Database_file_path=D:\\校友会校友资料\\筹200220\\        ##问卷文件存放路径
OUT_path=                                              ##结果输出路径，不填的话就是当前路径
OUT_resume_path=H:\\my_code\\some_programs\\database_xiaoyou\\all_resume\\   ##简历文件的输出路径，建议放到一个文件夹中

[base_time]
Base_update_time=2019-12-15              ##base文件的更新时间，字段覆盖的时候会读取时间判断早晚

[out_put]   
OUT_Same_database_file=Same_database     ##疑似数据库的输出文件名字
OUT_total_result_file=All_result          ##全部结果的输出文件名字


2:config.json   ##这个记录了每个问卷的名字和时间
例如 "1805“真需求、真服务、真温暖”南燕校友会调查问卷_177_177.xls":"2018-05-14",  ##表示这个文件的名字，以及创建时间是2018年5月14日

3：identify.json
这个可以不用动， 这个是我人工整理的，对于问卷表头信息的分析提取。例如："14":["所在城市","城市","居住市"],  意思是说如果问卷的某个问题表头出现了所在城市，或者城市，或者居住市，我认为这个问题问的是居住所在市，将这个信息保存到居住所在市
后期有需要可以直接在上面添加